/*
 * @LastEditors: aFei
 * @LastEditTime: 2022-12-05 16:08:26
*/
(function(u){typeof define=="function"&&define.amd?define(u):u()})(function(){"use strict";let u=e=>{let a=Object.prototype.toString,t={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"};return e instanceof Element?"element":t[a.call(e)]},q=e=>{let a=u(e),t;if(a==="array")t=[];else if(a==="object")t={};else return e;if(a==="array")for(let l=0,r=e.length;l<r;l++)t.push(q(e[l]));else if(a==="object")for(let l in e)t[l]=q(e[l]);return t},O=(e,a)=>{let t={vx:0,vy:0,pal:0,scale:0};if(u(e.x)!="number"||u(e.y)!="number"||u(e.deg)!="number"&&u(e.deg)!="undefined"||u(e.zoom)!="number")return{};let l=u(a.vx)!="number"?t.vx:a.vx,r=u(a.vy)!="number"?t.vy:a.vy,g=u(a.pal)!="number"?t.pal:a.pal,s=u(a.scale)!="number"?t.scale:a.scale;return e.x+=l,e.y+=r,e.deg+=g,e.zoom+=s,e},H=(e,a)=>{let t={ax:0,ay:0,apal:0,ascale:0};if(u(e.vx)!="number"||u(e.vy)!="number"||u(e.pal)!="number"||u(e.scale)!="number")return{};let l=u(a.ax)!="number"?t.ax:a.ax,r=u(a.ay)!="number"?t.ay:a.ay,g=u(a.apal)!="number"?t.apal:a.apal,s=u(a.ascale)!="number"?t.ascale:a.ascale;return e.vx+=l,e.vy+=r,e.pal+=g,e.scale+=s,e},C=()=>{let e=Math.floor(Math.random()*256),a=Math.floor(Math.random()*256),t=Math.floor(Math.random()*256),l="rgb($r, $g, $b)";return l=l.replace("$r",e),l=l.replace("$g",a),l=l.replace("$b",t),l},P={getInstance:()=>{let e={},a=100,t=Y.getInstance(),l=Z.getInstance(),r=I.getInstance(),g=[],s=0,n=U,o=.1,h=1,M=0,i={};return e.setBeforeBalst=c=>{t.setAnimate(c)},e.getBeforeBalst=()=>t,e.setInBalst=c=>{l.setAnimate(c)},e.getInBalst=()=>l,e.setAfterBalst=c=>{r.setAnimate(c)},e.getAfterBalst=()=>r,e.setAfterBalstList=c=>{g=c},e.getAfterBalstList=()=>g,e.setCtx=c=>{i=c},e.getCtx=()=>i,e.setStatus=c=>{s=c},e.getStatus=()=>s,e.setRoundness=c=>{h=c},e.getRoundness=()=>h,e.setResistance=c=>{o=c},e.getResistance=()=>o,e.setNum=c=>{a=c},e.getNum=()=>a,e.setDelay=c=>{M=c},e.getDelay=()=>M,e.setFireworkType=c=>{n=c},e.getFireworkType=()=>n,e.draw=()=>{if(s===2)i.beginPath(),i.arc(t.getAnimate().getQuiescence().x,t.getAnimate().getQuiescence().y,t.getR(),0,Math.PI*2),i.closePath(),i.fillStyle=t.getColor(),i.fill();else if(s===3){let c=l.getAnimate().getQuiescence().x,f=l.getAnimate().getQuiescence().y,m=l.getR(),R=l.getColor(),v=l.getAlpha(),y=i.createRadialGradient(c,f,0,c,f,m);y.addColorStop(0,"#FFFFFF"),y.addColorStop(.2,R),y.addColorStop(1,"rgba(0, 0, 0, 0)"),i.globalAlpha=v,i.fillStyle=y,i.fillRect(c-m,f-m,m*2,m*2)}else if(s===4)for(let c=0;c<g.length;c++){let f=g[c],m=f.getAnimate(),R=m.getQuiescence().x,v=m.getQuiescence().y,y=f.getR(),L=f.getColor(),b=f.getDelay()>0?0:f.getAlpha();i.beginPath(),i.globalAlpha=b,i.arc(R,v,y,0,Math.PI*2),i.closePath(),i.fillStyle=L,i.fill()}},e.update=()=>{if(s===1)M--,M<=0&&(s=2);else if(s===2){let c=t.getAnimate(),f=c.getMove(),m=c.getQuiescence(),R=c.getTranslate(),v=t.getLife();H(f,R),O(m,f),t.setLife(--v),v<=0&&(s=3,l.setLife(1),l.setColor("#FFFFFF"),l.setR(400),l.setAlpha(.4),l.setAnimate({quiescence:{x:m.x,y:m.y}}))}else if(s===3){let c=l.getLife();l.setLife(--c),c<=0&&(s=4,n(e))}else if(s===4)for(let c=g.length-1;c>=0;c--){let f=g[c],m=f.getAnimate(),R=m.getQuiescence(),v=m.getMove(),y=m.getTranslate(),L=f.getLife(),b=f.getBase(),B=f.getCustomG(),p=f.getDelay();p<=0?(y.ax=-v.vx*o,y.ay=(u(B)==="number"?B:x)-v.vy*o,Math.abs(y.ay)<Math.pow(10,-8)&&(y.ay=0),Math.abs(y.ax)<Math.pow(10,-8)&&(y.ax=0),H(v,y),O(R,v),f.setLife(--L),f.setAlpha(.2+L/b.life*b.alpha),L<=0&&g.splice(c,1),g.length===0&&(s=5)):f.setDelay(--p)}},e}},Y={getInstance:()=>{let e={},a=D.getInstance(),t=0,l=0,r="#000000",g={};return e.setAnimate=s=>{let n=u(s.quiescence)==="object"?s.quiescence:{},o=u(s.move)==="object"?s.move:{},h=u(s.translate)==="object"?s.translate:{};a.setQuiescence(n),a.setMove(o),a.setTranslate(h)},e.getAnimate=()=>a,e.setR=s=>{t=s},e.getR=()=>t,e.setColor=s=>{r=s},e.getColor=()=>r,e.setLife=s=>{l=s},e.getLife=()=>l,e.setBase=()=>{g.animate={quiescence:q(e.getAnimate().getQuiescence()),move:q(e.getAnimate().getMove()),translate:q(e.getAnimate().getTranslate())},g.r=t,g.color=r,g.life=l},e.getBase=()=>g,e}},Z={getInstance:()=>{let e={},a=D.getInstance(),t=0,l="#000000",r=0,g=.25;return e.setAnimate=s=>{let n=u(s.quiescence)==="object"?s.quiescence:{},o=u(s.move)==="object"?s.move:{},h=u(s.translate)==="object"?s.translate:{};a.setQuiescence(n),a.setMove(o),a.setTranslate(h)},e.getAnimate=()=>a,e.setR=s=>{t=s},e.getR=()=>t,e.setAlpha=s=>{g=s>1?1:s<0?0:s},e.getAlpha=()=>g,e.setColor=s=>{l=s},e.getColor=()=>l,e.setLife=s=>{r=s},e.getLife=()=>r,e}},I={getInstance:()=>{let e={},a=D.getInstance(),t={},l=1,r=0,g="#FFFFFF",s=0,n=0,o=null;return e.setBase=()=>{t.life=s,t.alpha=l},e.getBase=()=>t,e.setAnimate=h=>{let M=u(h.quiescence)==="object"?h.quiescence:{},i=u(h.move)==="object"?h.move:{},c=u(h.translate)==="object"?h.translate:{};a.setQuiescence(M),a.setMove(i),a.setTranslate(c)},e.getAnimate=()=>a,e.setAlpha=h=>{l=h>1?1:h<0?0:h},e.getAlpha=()=>l,e.setR=h=>{r=h},e.getR=()=>r,e.setDelay=h=>{n=h},e.getDelay=()=>n,e.setCustomG=h=>{o=h},e.getCustomG=()=>o,e.setColor=h=>{g=h},e.getColor=()=>g,e.setLife=h=>{s=h},e.getLife=()=>s,e}},D={getInstance:()=>{let e={},a={x:0,y:0,deg:0,zoom:1},t={vx:0,vy:0,pal:0,scale:0},l={ax:0,ay:0,apal:0,ascale:0};return e.setQuiescence=r=>{a.x=u(r.x)!="number"?a.x:r.x,a.y=u(r.y)!="number"?a.y:r.y,a.deg=u(r.deg)!="number"?a.deg:r.deg,a.zoom=u(r.zoom)!="number"?a.zoom:r.zoom},e.getQuiescence=()=>a,e.setMove=r=>{t.vx=u(r.vx)!="number"?t.vx:r.vx,t.vy=u(r.vy)!="number"?t.vy:r.vy,t.pal=u(r.pal)!="number"?t.pal:r.pal,t.scale=u(r.scale)!="number"?t.scale:r.scale},e.getMove=()=>t,e.setTranslate=r=>{l.ax=u(r.ax)!="number"?l.ax:r.ax,l.ay=u(r.ay)!="number"?l.ay:r.ay,l.apal=u(r.apal)!="number"?l.apal:r.apal,l.ascale=u(r.ascale)!="number"?l.ascale:r.ascale},e.getTranslate=()=>l,e}},U=e=>{let a=e.getInBalst(),t=e.getNum(),l=e.getRoundness(),r=e.getResistance(),g=[];for(let s=0;s<t;s++){let n=I.getInstance(),o=s*2*Math.PI/t,h=a.getAnimate(),M=h.getQuiescence(),i=20*(l+(1-l)*Math.random());n.setLife(50+Math.floor(Math.random()*40)),n.setColor(C()),n.setAlpha(1),n.setR(2),n.setAnimate({quiescence:{x:M.x,y:M.y},move:{vx:Math.cos(o)*i,vy:Math.sin(o)*i},translate:{ax:Math.cos(o)*i*-r,ay:x-r*Math.sin(o)*i}}),n.setBase(),g.push(n)}e.setAfterBalstList(g)},_=e=>{let a=e.getInBalst(),t=e.getNum(),l=e.getRoundness(),r=e.getResistance(),g=[];for(let s=0;s<t;s++){let n=I.getInstance(),o=s*2*Math.PI/t,h=a.getAnimate(),M=h.getQuiescence(),i=20*(l+(1-l)*Math.random());n.setLife(50+Math.floor(Math.random()*40)),n.setColor(C()),n.setAlpha(1),n.setR(2),n.setAnimate({quiescence:{x:M.x,y:M.y},move:{vx:16*Math.pow(Math.sin(o),3)/13*i,vy:-(13*Math.cos(o)-5*Math.cos(2*o)-2*Math.cos(3*o)-Math.cos(4*o))/13*i},translate:{ax:16*Math.pow(Math.sin(o),3)/13*i*-r,ay:x-r*-(13*Math.cos(o)-5*Math.cos(2*o)-2*Math.cos(3*o)-Math.cos(4*o))/13*i}}),n.setBase(),g.push(n)}e.setAfterBalstList(g)},ee=e=>{let a=e.getInBalst(),t=e.getNum(),l=e.getRoundness(),r=e.getResistance(),g=[];for(let s=0;s<t;s++){let n=s*2*Math.PI/t,o=a.getAnimate(),h=o.getQuiescence(),M=20*(l+(1-l)*Math.random());if(s>t/16&&s<t*5/8){let c=I.getInstance();c.setLife(50+Math.floor(Math.random()*40)),c.setColor(C()),c.setAlpha(1),c.setR(2),c.setAnimate({quiescence:{x:h.x,y:h.y},move:{vx:16*Math.pow(Math.sin(n),3)/13*M+20,vy:-(13*Math.cos(n)-5*Math.cos(2*n)-2*Math.cos(3*n)-Math.cos(4*n))/13*M},translate:{ax:(16*Math.pow(Math.sin(n),3)/13*M+20)*-r,ay:x-r*-(13*Math.cos(n)-5*Math.cos(2*n)-2*Math.cos(3*n)-Math.cos(4*n))/13*M}}),c.setBase(),g.push(c)}let i=I.getInstance();i.setLife(50+Math.floor(Math.random()*40)),i.setColor(C()),i.setAlpha(1),i.setR(2),i.setAnimate({quiescence:{x:h.x,y:h.y},move:{vx:16*Math.pow(Math.sin(n),3)/13*M,vy:-(13*Math.cos(n)-5*Math.cos(2*n)-2*Math.cos(3*n)-Math.cos(4*n))/13*M},translate:{ax:16*Math.pow(Math.sin(n),3)/13*M*-r,ay:x-r*-(13*Math.cos(n)-5*Math.cos(2*n)-2*Math.cos(3*n)-Math.cos(4*n))/13*M}}),i.setBase(),g.push(i)}t=Math.floor(t/4);for(let s=0;s<t;s++){let n=I.getInstance(),o=0,h=a.getAnimate(),M=h.getQuiescence(),i=20*(l+(1-l)*Math.random());n.setLife(50+Math.floor(Math.random()*40)),n.setColor(C()),n.setAlpha(1),n.setR(2),n.setAnimate({quiescence:{x:M.x,y:M.y},move:{vx:Math.cos(o)*i+20+30*s/t,vy:Math.sin(o)*i},translate:{ax:(Math.cos(o)*i+20+30*s/t)*-r,ay:x-r*Math.sin(o)*i}}),n.setBase(),g.push(n)}t=Math.floor(t*4/3);for(let s=0;s<t;s++){let n=I.getInstance(),o=Math.PI,h=a.getAnimate(),M=h.getQuiescence(),i=20*(l+(1-l)*Math.random());n.setLife(50+Math.floor(Math.random()*40)),n.setColor(C()),n.setAlpha(1),n.setR(2),n.setAnimate({quiescence:{x:M.x,y:M.y},move:{vx:Math.cos(o)*i+10-30*s/t,vy:Math.sin(o)*i},translate:{ax:(Math.cos(o)*i+10-30*s/t)*-r,ay:x-r*Math.sin(o)*i}}),n.setBase(),g.push(n)}t=Math.floor(t*12/5);for(let s=0;s<t;s++){let n=I.getInstance(),o=s*2*Math.PI/t,h=a.getAnimate(),M=h.getQuiescence(),i=20*(l+(1-l)*Math.random())/6;n.setLife(50+Math.floor(Math.random()*40)),n.setColor(C()),n.setAlpha(1),n.setR(2),n.setAnimate({quiescence:{x:M.x,y:M.y},move:{vx:(13*Math.cos(o)-5*Math.cos(2*o)-2*Math.cos(3*o)-Math.cos(4*o))/13*i-40,vy:16*Math.pow(Math.sin(o),3)/13*i},translate:{ax:((13*Math.cos(o)-5*Math.cos(2*o)-2*Math.cos(3*o)-Math.cos(4*o))/13*i-40)*-r,ay:x-r*16*Math.pow(Math.sin(o),3)/13*i}}),n.setBase(),g.push(n)}e.setAfterBalstList(g)},te=e=>{let a=e.getInBalst(),t=e.getNum(),l=e.getRoundness(),r=e.getResistance(),g=[];for(let s=0;s<t;s++){let n=I.getInstance(),o=s*2*Math.PI/t,h=a.getAnimate(),M=h.getQuiescence(),i=20*(l+(1-l)*Math.random());n.setLife(50+Math.floor(Math.random()*40)),n.setColor(C()),n.setAlpha(1),n.setR(2),n.setAnimate({quiescence:{x:M.x,y:M.y},move:{vx:Math.cos(o)*i*Math.cos(15*Math.PI/180)+Math.sin(o)*i/4*Math.sin(15*Math.PI/180),vy:Math.sin(o)*i/4*Math.cos(15*Math.PI/180)-Math.cos(o)*i*Math.sin(15*Math.PI/180)},translate:{ax:(Math.cos(o)*i*Math.cos(15*Math.PI/180)+Math.sin(o)*i/4*Math.sin(15*Math.PI/180))*-r,ay:x-r*(Math.sin(o)*i/4*Math.cos(15*Math.PI/180)-Math.cos(o)*i*Math.sin(15*Math.PI/180))}}),n.setBase(),g.push(n)}e.setAfterBalstList(g)},ae=e=>{let a=e.getInBalst(),t=e.getRoundness(),l=e.getResistance(),r=a.getAnimate(),g=r.getQuiescence(),s=[],n=x/10,o=10,h=1.5,M=0;$.each(le,function(i,c){let f=oe[c],m=f.length,R=V[i*2],v=V[i*2+1];for(let y=0;y<m;y++)for(let L=0;L<9;L++){let b=f[y][0],B=f[y][1];switch(L){case 0:b-=3.5/o,B-=3.5/o;break;case 1:B-=3.5/o;break;case 2:b+=3.5/o,B-=3.5/o;break;case 3:b-=3.5/o;break;case 4:break;case 5:b+=3.5/o;break;case 6:b-=3.5/o,B+=3.5/o;break;case 7:B+=3.5/o;break;case 8:b+=3.5/o,B+=3.5/o;break}let p=I.getInstance(),j=Math.sqrt(Math.pow(b,2)+Math.pow(B,2)),W=j===0?0:b/j,X=j===0?0:B/j,S=2*(t+(1-t)*Math.random());p.setDelay(M),p.setLife(200+Math.floor(Math.random()*40)),p.setColor(C()),p.setAlpha(1),p.setR(h),p.setCustomG(n),p.setAnimate({quiescence:{x:g.x+R,y:g.y+v},move:{vx:S*j*W,vy:S*j*X},translate:{ax:S*j*W*-l,ay:n-l*(S*j*X)}}),p.setBase(),s.push(p)}M+=2}),e.setAfterBalstList(s)},T=(e,a)=>{let t=e.getBeforeBalst();e.setCtx(F),e.setStatus(1),e.setNum(100+Math.floor(20*Math.random())),e.setRoundness(u(a)==="object"&&u(a.roundness)==="number"?a.roundness:.25),e.setFireworkType(u(a)==="object"?a.fireworkType:K[Math.floor(Math.random()*K.length)]),e.setDelay(Math.floor(30*Math.random())),t.setAnimate({quiescence:{x:d.width/2,y:d.height,deg:0,zoom:1},move:{vx:u(a)==="object"&&a.vx===0?0:($(d).width()<1e3?-4:-7)+Math.random()*($(d).width()<1e3?8:14),vy:u(a)==="object"&&a.vy.value?a.vy.num:($(d).height()>1e3?-25:-21)+4*Math.random(),pal:0,scale:0},translate:{ax:0,ay:x,apal:0,scale:0}}),t.setR(3),t.setColor("#FFFFFF"),t.setLife(50+Math.floor(Math.random()*50)),t.setBase()},se=()=>{F.globalCompositeOperation="source-over",F.globalAlpha=.2,F.fillStyle="#000003",F.fillRect(0,0,d.width,d.height),F.globalCompositeOperation="screen",$.each(A,function(e,a){a.draw()})},ne=()=>{for(let e=A.length-1;e>=0;e--)if(A[e].update(),A[e].getStatus()===5){if(A.splice(e,1),w<z){let a=P.getInstance();T(a),A.push(a),w++}if(A.length===0)if(Q)setTimeout(E?function(){F.clearRect(0,0,d.width,d.height),Q=!1,w=0,G(msg)}:function(){F.clearRect(0,0,d.width,d.height),$(".delong").show()},300);else{if(k){let a=P.getInstance();T(a,{fireworkType:ae,vx:0,vy:{value:!0,num:$(d).height()>1e3?-22:-18},roundness:1}),A.push(a);let t=P.getInstance();T(t,{fireworkType:ee,vx:0,vy:{value:!0,num:$(d).height()>1e3?-24:-20},roundness:1}),A.push(t)}Q=!0}}},J=()=>{(A.length>0||!Q)&&(se(),ne(),requestAnimationFrame(J))},d=$("canvas")[0],F=d.getContext("2d"),x=.25,N=5,A=[],K=[U,te,_],w=0,z=25,k=!0,Q=!1,E=!1;d.width=$(d).width(),d.height=$(d).height();let le=["\u5362","\u83F2","\u751F","\u65E5","\u5FEB","\u4E50"],V=[-200,0,200,0,-375,250,-125,250,125,250,375,250],oe={\u5362:[[0,-6],[0,-5],[0,-4],[0,-3],[0,-5],[1,-5],[2,-5],[3,-5],[-2.5,-2],[-1.5,-2],[-.5,-2],[.5,-2],[1.5,-2],[2.5,-2],[2.5,-1],[2.5,0],[-2.5,1],[-1.5,1],[-.5,1],[.5,1],[1.5,1],[2.5,1],[-2.5,-1],[-2.5,0],[-2.5,.5],[-2.8,1.5],[-3.1,2.5],[-3.5,3.5],[-4,4]],\u83F2:[[-3,-5],[-2,-5],[-1,-5],[0,-5],[1,-5],[2,-5],[3,-5],[-1.5,-6],[-1.5,-5],[-1.5,-4],[1.5,-6],[1.5,-5],[1.5,-4],[-1,-2.5],[-1,-1.5],[-1,-.5],[-1,.5],[-1,1.5],[-1,2.5],[-1,3.5],[-3,-2],[-2,-2],[-1,-2],[-3,-.5],[-2,-.5],[-1,-.5],[-3,1],[-2,1],[-1,1],[1,-2.5],[1,-1.5],[1,-.5],[1,.5],[1,1.5],[1,2.5],[1,3.5],[3,-2],[2,-2],[1,-2],[3,-.5],[2,-.5],[1,-.5],[3,1],[2,1],[1,1]],\u751F:[[-3,-4],[-3.5,-3],[-4,-2],[-5,-1],[-6,0],[-3,-2],[-2,-2],[-1,-2],[0,-2],[1,-2],[2,-2],[3,-2],[-2,1],[-1,1],[0,1],[1,1],[2,1],[0,-5],[0,-4],[0,-3],[0,-1],[0,0],[0,2],[0,3],[0,4],[-5,5],[-4,5],[-3,5],[-2,5],[-1,5],[0,5],[1,5],[2,5],[3,5],[4,5]],\u65E5:[[-3,-4],[-3,-3],[-3,-2],[-3,-1],[-3,0],[-3,1],[-3,2],[-3,3],[-3,4],[-3,5],[-2,-4],[-1,-4],[0,-4],[1,-4],[2,-4],[3,-4],[3,-3],[3,-2],[3,-1],[3,0],[3,1],[3,2],[3,3],[3,4],[3,5],[-2,.5],[-1,.5],[0,.5],[1,.5],[2,.5],[-2,5],[-1,5],[0,5],[1,5],[2,5]],\u5FEB:[[-4,-5],[-4,-4],[-4,-3],[-4,-2],[-4,-1],[-4,0],[-4,1],[-4,2],[-4,3],[-4,4],[-4,5],[-5.5,-1],[-5.5,0],[-6.5,1],[-3,-2],[-2,-1],[-1,-2],[0,-2],[1,-2],[2,-2],[3,-2],[4,-2],[4,-1],[4,0],[-2,1],[-1,1],[0,1],[1,1],[2,1],[3,1],[4,1],[5,1],[1,-5],[1,-4],[1,-3],[1,-1],[1,0],[1,2],[0,3],[-1,4],[-2,5],[2,3],[3,4],[4,5]],\u4E50:[[3,-5],[2,-4.5],[1,-4],[0,-4],[-1,-4],[-2,-4],[-3,-4],[-4,-4],[-4,-3],[-4,-2],[-4,-1],[-4,0],[-3,0],[-2,0],[-1,0],[0,0],[1,0],[2,0],[3,0],[4,0],[0,-3],[0,-2],[0,-1],[0,1],[0,2],[0,3],[0,4],[0,5],[-1,4.5],[-1.5,4],[-2,2],[-3,3],[-4,4],[2,2],[3,3],[4,4]]},G=e=>{x=e.g!==void 0?e.g:x,N=e.n!==void 0?e.n:N,z=e.surprise_num!==void 0?e.surprise_num:z,k=e.flag!==void 0?e.flag:k,E=e.infinite!==void 0?e.infinite:E;for(let a=0;a<N;a++){let t=P.getInstance();T(t),A.push(t),w++}J()};window.begin=G,$(".delong button").on("click",function(){Q=!1,w=0,G(msg),$(".delong").hide()})});